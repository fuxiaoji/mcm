% 层次分析法(AHP)案例说明：
% 本案例用于评价3个备选方案，通过3个评价指标进行比较。
% 判断矩阵A中，A(i,j)表示第i个指标相对于第j个指标的重要性程度，
% 采用1-9标度法：1表示同等重要，3表示稍微重要，5表示明显重要，
% 7表示强烈重要，9表示极端重要，倒数表示相反关系。

% 构建判断矩阵（3个指标之间的重要性比较）
A = [
    1, 2, 3;       % 指标1与其他指标的比较：比指标2稍重要，比指标3明显重要
    1/2, 1, 2;     % 指标2与其他指标的比较：比指标1次要，比指标3稍重要
    1/3, 1/2, 1];  % 指标3与其他指标的比较：比指标1和2都次要

n = size(A, 1);  % 获取判断矩阵的阶数

% 计算最大特征值和对应的特征向量
[V, D] = eig(A);               % V为特征向量矩阵，D为特征值对角矩阵
max_eig = max(diag(D));        % 提取最大特征值
[~, idx] = max(diag(D));       % 找到最大特征值的索引
w = V(:, idx);                 % 获取对应的特征向量
w = w / sum(w);                % 归一化处理，得到权重向量

% 一致性检验
CI = (max_eig - n) / (n - 1);  % 计算一致性指标
% 平均随机一致性指标RI（对应1-11阶矩阵）
RI = [0, 0, 0.58, 0.90, 1.12, 1.24, 1.32, 1.41, 1.45, 1.49, 1.51];
CR = CI / RI(n+1);             % 计算一致性比率（Matlab索引从1开始）

% 输出结果
disp("层次分析法计算结果：");
fprintf("判断矩阵阶数: %d\n", n);
fprintf("最大特征值: %.4f\n", max_eig);
disp("指标权重向量:");
disp(round(w, 4));
fprintf("一致性指标CI: %.4f\n", CI);
fprintf("一致性比率CR: %.4f\n", CR);
if CR < 0.1
    disp("判断矩阵通过一致性检验");
else
    disp("判断矩阵未通过一致性检验");
end
