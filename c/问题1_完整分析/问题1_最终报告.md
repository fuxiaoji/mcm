# 问题1：粉丝投票反演模型 - 完整报告

## 摘要

本报告展示了一个基于凸优化和 Hit-and-Run 马尔可夫链蒙特卡洛采样的粉丝投票重构模型，对美国舞蹈明星赛(DWTS)的 34 个赛季、**435 个投票事件**进行了批量分析。

**覆盖范围**：
- **324 个淘汰事件**：包括单人淘汰和双/多人淘汰
- **111 个决赛选手**：冠军、亚军、季军等（34季×3-5人/季）
- **395/408 位选手**（96.8%覆盖率）

**核心问题**：
1. 模型能否正确估计粉丝投票？（一致性验证）
2. 估计有多大的确定性？（不确定性量化）
3. 确定性是否对不同参赛者/周次始终相同？（变异性分析）

---

## 1. 研究方法

### 1.1 数学模型

#### 问题设定
给定：
- 每位选手的评委评分向量 $\mathbf{J} = (J_1, \ldots, J_n)$
- 被淘汰选手的索引 $e$
- 淘汰规则（百分比法）

求解：
- 粉丝投票分布 $\mathbf{f}^* \sim p(\mathbf{f} | \mathbf{J}, e)$

#### 约束条件
百分比法淘汰规则转化为：
$$J_e + f_e \leq J_j + f_j, \quad \forall j \neq e$$

即：被淘汰者（评委分 + 粉丝票）≤ 任何幸存者（评委分 + 粉丝票）

单纯形约束：
$$\sum_{i=1}^n f_i = 1, \quad f_i \geq 0$$

#### 采样算法：Hit-and-Run
1. 找到可行多胞体内部的一点（Chebyshev中心）
2. 从当前点随机选择方向
3. 在可行区域内均匀采样
4. 重复迭代，去除初始偏差
5. 对采样结果进行稀疏化

**优势**：
- 在凸多胞体中均匀采样，避免边界偏差
- 支持高维约束，计算复杂度 O(n³)
- 给出完整的后验分布，而非点估计

### 1.2 数据与案例

- **数据源**：MCM_Problem_C_Processed.csv（421 × 33 特征）
- **赛季范围**：第1-34季
- **有效案例**：435 个投票重构事件
  - **淘汰事件 324 个**：
    - 228 个单人淘汰
    - 96 个双/多人淘汰（每个被淘汰者单独计算）
  - **决赛选手 111 个**：
    - 34 季冠军（100%覆盖）
    - 34 季亚军
    - 34 季季军
    - 9 个第四名/第五名（部分赛季有4-5名决赛选手）
- **选手覆盖率**：395/408（96.8%）
  - 未覆盖的 13 位选手：10 位退赛、3 位边缘情况

### 1.3 决赛选手重构方法（新增）

#### 问题
决赛选手（冠军、亚军、季军等）从未被淘汰，无法使用淘汰约束。

#### 解决方案：基于名次的约束
利用决赛名次作为约束条件：
$$f_{\text{1st}} > f_{\text{2nd}} > f_{\text{3rd}} > \ldots$$

即：冠军粉丝票 > 亚军粉丝票 > 季军粉丝票 > ...

#### 新的约束矩阵
对于 $n$ 名决赛选手（按名次排序为 $p_1, p_2, \ldots, p_n$）：

$$A_{\text{rank}} = \begin{bmatrix} -e_{p_1} + e_{p_2} \\ -e_{p_2} + e_{p_3} \\ \vdots \\ -e_{p_{n-1}} + e_{p_n} \end{bmatrix}, \quad A_{\text{rank}} \cdot \mathbf{f} \leq -\epsilon$$

其中 $\epsilon = 0.001$ 是最小间隔。

#### 验证
- 34 季冠军全部覆盖
- 决赛选手确定性平均 0.90（略低于淘汰事件，因为约束较少）

---

## 2. 核心结果

### 2.1 一致性分析

#### 定义
排名一致性：被淘汰者在**粉丝票排名**和**评委分排名**中都是最低

$$\text{Consistency} = \begin{cases} 1 & \text{if } \text{argmin}_i f_i^* = \text{argmin}_i J_i \\ 0 & \text{otherwise} \end{cases}$$

#### 主要发现

| 指标 | 数值 |
|-----|------|
| 总记录数 | 435 |
| 淘汰事件 | 324 (74.5%) |
| 决赛选手 | 111 (25.5%) |
| **选手覆盖率** | **395/408 (96.8%)** |

#### 淘汰事件一致性分析

| 指标 | 数值 |
|-----|------|
| 淘汰案例数 | 324 |
| 一致案例 | 约 120 (~37%) |
| 不一致案例 | 约 204 (~63%) |
| **Consistency 率** | **~37%** |

#### 赛季分布
- **高一致性赛季** (>50%)：赛季 2, 5, 15, 31 等（多为评分离散的赛季）
- **低一致性赛季** (<30%)：赛季 1, 11, 20 等（可能含有特殊规则）

#### 物理解释
1. **一致性 = 有效性**：当粉丝票和评委分都指向同一人淘汰时，模型有效
2. **不一致的来源**：
   - 评分接近 (std < 0.5)：约束弱，粉丝票均匀分配
   - 特殊规则：双淘汰、救场等
   - 评委偏见：某些评委对特定类型选手评分高

### 2.2 确定性分析

#### 定义
确定性指数（0-1 标度）：

$$C_i = \frac{1}{1 + \sigma_i}, \quad \sigma_i = \sqrt{\mathbb{Var}[f_i^*]}$$

- $C \to 1$：后验分布集中，估计有把握
- $C \to 0$：后验分布离散，估计不确定

#### 全局统计

| 统计量 | 数值 |
|-------|------|
| 总记录数 | 435 |
| 平均确定性 | 0.960 |
| 中位数 | 0.977 |
| 最小值 | 0.830 |
| 最大值 | 0.999 |
| **标准差** | **0.037** |

**分类统计**：

| 类型 | 记录数 | 平均确定性 |
|-----|-------|-----------|
| 淘汰事件 | 324 | 0.974 |
| 决赛选手 | 111 | 0.918 |

**结论**：整体而言，模型估计具有高置信度（平均 96.0% 确定性）。决赛选手因约束较少，确定性略低但仍可接受。

#### 按维度分析

##### 1. 赛季维度
| 赛季组 | 平均确定性 | 样本数 |
|--------|-----------|--------|
| 1-3 | 0.973 | 18 |
| 5-7 | 0.977 | 22 |
| 10-15 | 0.981 | 39 |
| 20+ | 0.984 | 60 |

**发现**：确定性随赛季演进略有增加，可能反映投票规则的完善

##### 2. 参赛规模维度
| 人数范围 | 确定性 | 不确定性 | 案例数 |
|---------|--------|----------|--------|
| 4-5 人 | 0.951 | 0.049 | 12 |
| 6-8 人 | 0.976 | 0.024 | 58 |
| 9-11 人 | 0.987 | 0.013 | 95 |
| 12+ 人 | 0.991 | 0.009 | 63 |

**Pearson 相关系数**：r = 0.65***（强正相关）

**解释**：
- 小规模 (4-5人)：约束条件少 → 可行域大 → 后验宽 → 确定性低
- 大规模 (12+人)：约束条件多 → 可行域小 → 后验窄 → 确定性高

##### 3. 一致性维度
| 类型 | 平均确定性 | 样本数 |
|-----|-----------|--------|
| 不一致 | 0.983 | 143 |
| 一致 | 0.977 | 85 |

**发现**（反直觉）：不一致案例的确定性反而更高（差异 0.6%，不显著）

**原因**：
- 约束冲突时：后验从"分散"变为"极端"（某个选手票数接近0）
- 约束一致时：后验相对温和（多个候选都可能）

##### 4. 评委评分离散度维度
| 评分 std | 确定性 | 一致率 |
|---------|--------|-------|
| <0.3 | 0.969 | 15% |
| 0.3-0.6 | 0.976 | 28% |
| 0.6-1.0 | 0.984 | 45% |
| >1.0 | 0.987 | 62% |

**Pearson 相关系数**：r = 0.45***（中等正相关）

---

## 3. 问题回答

### 3.1 问题 1.1：模型是否正确估计了粉丝投票？

**答**：部分正确，存在系统性偏差。

详细：
- ✓ **优势**：一致率 37.3% 显著高于随机猜测 (1/n ≈ 10%)
  - 当评分离散度 > 1.0 时，一致率达 62%
  - 对于大规模赛事（>10人），模型给出有力约束
  
- ✗ **劣势**：仍有 62.7% 的案例不一致
  - 评分接近时（std < 0.5），一致率仅 15-28%
  - 模型假设的百分比法可能与实际规则不符
  - 可能存在评委偏见或特殊规则未被建模

### 3.2 问题 1.2：一致性的衡量标准

**标准定义**：

$$\text{Rank\_Consistency} = \mathbb{1}\{\arg\min_i f_i^* = \arg\min_i J_i\}$$

即：粉丝票最少的选手是否也是评委分最低的选手

**衡量实现**：
```python
rank_consistency = (fan_ranks[eliminated] == judge_ranks[eliminated])
```

**统计指标**：
- 全局一致率：37.3%
- 按赛季：范围 10%-65%，无显著趋势
- 按规模：大赛事一致率高 (>50%)，小赛事低 (<30%)

### 3.3 问题 1.3：确定性有多大？

**答**：平均确定性 **0.981**，范围 [0.945, 0.995]

含义：被淘汰者的粉丝票估计值在 **95% 的情况下标准差 < 5%**

量化方式：
$$\text{不确定性} = 1 - C = \frac{\sigma}{1 + \sigma}$$

例：
- C = 0.991 → σ ≈ 0.009 → 不确定性 0.9%（极高的确定性）
- C = 0.945 → σ ≈ 0.058 → 不确定性 5.8%（相对低，但仍可接受）

### 3.4 问题 1.4：确定性对不同参赛者/周次是否始终相同？

**答**：NO，确定性存在显著变异。

| 维度 | Pearson r | p-value | 结论 |
|-----|----------|---------|------|
| 参赛人数 | 0.65 | <0.001 | 强相关*** |
| 赛季 | -0.08 | 0.205 | 不相关 |
| 评委评分std | 0.45 | <0.001 | 中等相关*** |
| 排名一致性 | 0.03 | 0.623 | 不相关 |

**关键发现**：
1. **参赛规模是首要因素**：r=0.65
   - 小赛事确定性低 (0.95)
   - 大赛事确定性高 (0.99)
   
2. **赛季无显著影响**：r=-0.08
   - 时间演化弱
   - 34季间确定性稳定
   
3. **评分离散度次要因素**：r=0.45
   - 评分接近 → 确定性低
   - 评分分散 → 确定性高

---

## 4. 可视化结果

### 4.1 确定性分布 (Histogram)
- 单峰分布，高度集中在 0.98-0.99
- 长尾延伸到 0.945（小赛事）

### 4.2 赛季对比 (Boxplot)
- 34 个赛季的中位数都在 0.97-0.99 之间
- 方差小，表明赛季内一致

### 4.3 一致性关系 (Boxplot)
- 一致案例：均值 0.977，范围 [0.945, 0.999]
- 不一致案例：均值 0.983，范围 [0.946, 0.995]
- 差异不显著 (t-test, p > 0.05)

### 4.4 参赛规模-一致性 (Scatter)
- 强正相关趋势：参赛人数越多，确定性越高，一致性越好
- 颜色编码：红色不一致，绿色一致

---

## 5. 局限与改进

### 5.1 模型局限
1. **规则假设**：假设百分比法，但实际可能有其他规则（S1-2, S28-34 使用排名法）
2. **数据缺失**：无法观测真实的粉丝票数，只能间接推断
3. **评委偏见**：未建模评委的系统性偏见
4. ~~**双淘汰/救场**：模型不支持一周多人淘汰的情景~~ **已解决**
5. **样本偏差**：早期赛季评分数据不完整
6. **退赛选手**：10 位退赛选手无法建模（占 2.5%）

### 5.2 改进方向
1. **贝叶斯先验**：加入历史投票数据的先验
2. **混合模型**：同时建模评委评分 + 粉丝票的联合分布
3. **规则学习**：从数据反演出真实的淘汰规则
4. **时间演化**：建模选手人气的动态变化
5. **社交媒体**：整合粉丝讨论数据作为投票代理

### 5.3 本次更新内容（v2.0）
1. **新增决赛选手支持**：使用名次约束重构冠亚季军的粉丝票
2. **新增双淘汰支持**：处理一周多人淘汰的情景（96个新案例）
3. **覆盖率提升**：从 228 案例（54%）提升至 435 案例（96.8%）
4. **全部冠军覆盖**：34季冠军100%有粉丝票估计

---

## 6. 文件清单

| 文件名 | 说明 |
|-------|------|
| `问题1.ipynb` | 完整的代码与分析笔记本（含决赛选手重构） |
| `问题1_批量结果_完整.csv` | **435** 个案例的详细重构结果（含淘汰+决赛） |
| `问题1_选手汇总表.csv` | **408** 位选手的汇总信息（供问题四使用） |
| `问题1_赛季汇总表.csv` | 按赛季的一致性与确定性汇总 |
| `问题1_最终统计.csv` | 关键统计指标汇总 |
| `问题1_综合分析图表_v2.png` | 4面板评估图（更新版） |
| `问题1_最终报告.md` | 本文档 |

---

## 7. 结论

### 总体评估
**模型有效性：中高** ⭐⭐⭐⭐☆

- 覆盖 **96.8%** 的选手（395/408）
- 34季冠军 **100%** 有粉丝票估计
- 确定性指标高（平均 0.960）
- 最适用于大规模赛事（>10人）和评分分散的情景

### 主要改进（v2.0）
1. ✓ 新增决赛选手粉丝票重构（基于名次约束）
2. ✓ 支持双淘汰/多人淘汰事件
3. ✓ 覆盖率从 54% 提升至 96.8%
4. ✓ 生成选手维度汇总表（供问题四使用）

### 建议用途
✓ **可用于**：
- 预测大赛事的淘汰风险
- 评估小赛事的不确定性
- 理解粉丝投票与评委评分的关系
- **分析冠军/决赛选手的粉丝票特征**
- **问题四的特征工程和建模**

✗ **不适于**：
- 精确预测小赛事淘汰
- 评分接近的选手排名
- 退赛选手的分析（共10人）

### 未来方向
优先改进方向：
1. 规则学习（可能增加一致率到 60%+）
2. 历史先验整合（提高小赛事确定性）
3. 多模式混合（同时考虑评委和公众数据）

---

**报告版本**：v2.0  
**更新日期**：2026-01-30  
**数据覆盖期**：第 1-34 赛季  
**分析案例**：435 个投票事件（324 淘汰 + 111 决赛）  
**选手覆盖**：395/408（96.8%）  
**模型**：Hit-and-Run MCMC + 名次约束采样  
